
# fork
- fork() 시스템 콜에 의해 새 프로세스 생성 가능.
- 자식 프로세스는 부모 프로세스의 address space(메모리 공간)를 그대로 메모리에 복제해서 생긴다.
- 두개의 프로세스(부모, 자식)는 fork() 시스템 콜 이후의 지시들을 계속 수행한다.
- 차이점은
  -  fork()후 리턴값이 0이면 자식프로세스이고, 0이 아닌 OS커널이 부여한 pid 를 리턴하면 부모 프로세스이다.
- fork() 시스템 콜 후
  - 부모는 계속 해서 실행 되거나(계속 실행 될 경우 부모 프로세스의 코드가 자식 프로세스보다 먼저 실행 된다) 또는
  - 자식 프로세스가 실행되는 동안 wait() 시스템 콜을 사용해 기다릴 수 있다. (이러면 자식프로세스의 코드가 부모 프로세스보다 먼저 실행)
  - wait() 시스템 콜을 사용하면 부모 프로세스는 ready queue에서 wait queue로 이동하고 자식 프로세스의 종료를 기다린다.


# 스레드 동기화
- 스레드 생성의 경우 프로세스 생성과 달리 한 프로세스 내에서 생성된 여러 스레드들은 메모리 주소 공간을 공유한다
- 한 프로세스 내에서 생성된 여러 프로세스들이 동시에 특정 전역 변수를 참조하는 경우를 생각해보자
- 예를 들어 예금 계좌 잔액을 나타내는 total 변수가 존재하고, 현재 잔고가 1000원이 있다고 가정할 때, 동시에 두 개의 쓰레드에서 total 변수를 참조해서 100원을 인출하는 상황을 생각해보자
- 첫 번째 스레드에서 현재 잔고가 1000원이므로 100원을 빼서 900원의 값을 total에 할당하는 중이고,
- 두 번째 스레드도 현재 잔고가 1000원인 시점에 참조해서 100원을 빼서 900원의 값을 total에 할당한다면, 실제로는 200원을 빼서 total 변수의 최종 값이 800원이 되어야 하지만 900원인 문제 상황이 발생할 수 있다.
- 위와 같이 동시에 공유 자원에 동시에 접근하는 상태를 `경쟁 상태`라 하고, 동시에 참조되는 공유 자원을 참조하는 영역, 즉 스레드가 실행 중 다른 스레드가 끼어들지 말아야 하는 영역을 `크리티컬 섹션`이라고 한다.
- 이 `크리티컬 섹션`을 `상호 배제(Mutual Exclusion)` 하는 방식으로 접근을 동기화해야 한다.
- pthread에서 상호 배제를 위해 제공하는 락(lock) 매커니즘으로 뮤텍스(mutex)가 존재한다.
